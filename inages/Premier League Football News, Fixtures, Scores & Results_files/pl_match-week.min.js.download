"use strict";PULSE.app.templates.matchweekblogentry='<div class="blogCard"><div class="cardMeta"><div class="icon {{ iconClass }}">{{#icon}}<div class="icn {{ icon.html }}"></div>{{/icon}}</div><time>{{ time }}</time></div><div class="cardContent {{ cardClass }}"><div class="score">{{ properties.score }}</div><h6 class="header">{{ title }}</h6><p>{{{ comment }}}</p></div></div>',PULSE.app.templates.matchweekheaderevent="<li>{{{ title }}}</li>",PULSE.app.templates.matchweekpinnedblogentry='<div class="blogCard blogCard__pinned"><div class="cardMeta"><div class="icon {{ iconClass }}">{{#icon}}<div class="icn {{ icon.html }}"></div>{{/icon}}</div><time>{{ time }}</time></div><div class="cardContent"><p class="label"><span class="icn pin-post-w"></span> {{ pinLabel }}</p><div class="score">{{ properties.score }}</div><h6 class="header">{{ title }}</h6><p>{{{ comment }}}</p></div></div>',PULSE.app.templates.eventmodaldetails='<div class="header"><div class="keymoment"><p>{{ time }}</p><h4>{{ eventLabel }}</h4></div><div class="score"><a href="{{ teams.0.url }}"><span class="badgeContainer"><span class="badge badge-image-container" data-widget="club-badge-image" data-size="25"><img class="badge-image badge-image--25 js-badge-image" src="{{ teams.0.clubBadge }}" srcset="{{ teams.0.clubBadge }}, {{ teams.0.clubBadgeRetina }} 2x"> </span></span><span class="visuallyHidden">{{ teams.0.name }}</span></a><h5><span class="{{ teams.0.teamClass }}"><a href="{{ teams.0.url }}"><span class="long">{{ teams.0.name }}</span><span class="short">{{ teams.0.abbr }}</span></a> {{ teams.0.score }}</span> - <span class="{{ teams.1.teamClass }}">{{ teams.1.score }} <a href="{{ teams.1.url }}"><span class="long">{{ teams.1.name }}</span><span class="short">{{ teams.1.abbr }}</span></a></span><h5><a href="{{ teams.1.url }}"><span class="badgeContainer"><span class="badge badge-image-container" data-widget="club-badge-image" data-size="25"><img class="badge-image badge-image--25 js-badge-image" src="{{ teams.1.clubBadge }}" srcset="{{ teams.1.clubBadge }}, {{ teams.1.clubBadgeRetina }} 2x"> </span></span><span class="visuallyHidden">{{ teams.1.name }}</span></a></h5></h5></div><a class="keyMomentLink" href="{{ url }}" class="btn">{{ mcLabel }}<span class="icn arrow-rightwhite"></span></a></div><div class="keyplayer">{{#playerImage}} <a href="{{ personUrl }}" class="keyplayer-image"><img class="playerPhotoContainer" data-player="{{ optaId }}" data-size="{{ imageSize }}" src="{{ image }}"> </a>{{/playerImage}}<div class="keyplayer-info"><h5><a href="{{ personUrl }}">{{ personName }}</a> <span><a href="{{ assistUrl }}">{{ assistLabel.long }} {{ assistName }}</a></span></h5></div></div>',PULSE.app.templates.matchweekevent='<div class="event {{ eventType }}"><span class="row"><span class="type"><span class="icn {{ eventClass }}"></span> {{ eventLabel }} </span><span class="score"><span class="{{ teams.0.teamClass }}">{{ teams.0.abbr }} <span class="badge badge-image-container" data-widget="club-badge-image" data-size="20"><img class="badge-image badge-image--20 js-badge-image" src="{{ teams.0.clubBadgeSmall }}" srcset="{{ teams.0.clubBadgeSmall }}, {{ teams.0.clubBadgeSmallRetina }} 2x"> </span>{{ teams.0.score }} </span><span class="dash">- </span><span class="{{ teams.1.teamClass }}">{{ teams.1.score }} <span class="badge badge-image-container" data-widget="club-badge-image" data-size="20"><img class="badge-image badge-image--20 js-badge-image" src="{{ teams.1.clubBadgeSmall }}" srcset="{{ teams.1.clubBadgeSmall }}, {{ teams.1.clubBadgeSmallRetina }} 2x"> </span>{{ teams.1.abbr }} </span></span></span>{{#personName}} <span class="row"><time class="min">{{ time }}</time> <span class="player">{{ personName }}</span> {{#assistPerson}} <span class="assist">{{ assistLabel.short }} {{ assistName }}</span> {{/assistPerson}} {{#modalLink}} <span class="icn add-w-sm matchEventModal"></span> {{/modalLink}} </span>{{/personName}}</div>',PULSE.app.templates.nomatchevents='<div class="noContentContainer">{{ label }}</div>',PULSE.app.templates.topplayer='<li class="col-4-m"><div class="statsCard"><header><h4 class="statsTitle">{{ statLabel }}</h4><div class="statsCardSocialShare" data-render="statsshare" data-link-to="{{ url }}"></div></header><ul class="statsList">{{#stats}}<li class="{{ statsClass }}"><div class="statInfo"><div class="pos">{{ index }}</div><div><a href="{{ url }}" class="statName">{{ owner.name.display }}</a> <a href="{{ team.url }}" class="statNameSecondary">{{ team.name }}</a></div></div><div class="stat">{{#smallTeamBadge}}<div class="statsBadge"><span class="badge badge-image-container" data-widget="club-badge-image" data-size="20"><img class="badge-image badge-image--20 js-badge-image" src="{{ clubBadgeSmall }}" srcset="{{ clubBadgeSmall }}, {{ clubBadgeSmallRetina }} 2x"></span></div>{{/smallTeamBadge}} {{ value }}</div>{{#largeTeamBadge}}<div class="heroBadgeContainer"><div class="statsBadge"><span class="badge badge-image-container" data-widget="club-badge-image" data-size="25"><img class="badge-image badge-image--25 js-badge-image" src="{{ clubBadge }}" srcset="{{ clubBadge }}, {{ clubBadgeRetina }} 2x"></span></div></div>{{/largeTeamBadge}} {{#playerImage}}<div class="imgCropContainer"><img class="img statCardImg playerPhotoContainer" data-player="{{ optaId }}" data-size="{{ imageSize }}" src="{{ playerImage }}"></div>{{/playerImage}}</li>{{/stats}}</ul><a class="btn widget-button" href="{{ url }}">{{ linkLabel }}<span class="icn arrow-right"></span></a></div></li>',PULSE.app.templates.latestmatchweektext='{{#contents}}<li><section class="featuredArticle">{{#hotlinkUrl}} <a href="{{ articleUrl }}?utm_source=premier-league-website&utm_campaign=website&utm_medium=link" target="_blank" class="thumbnail thumbLong">{{/hotlinkUrl}} {{^hotlinkUrl}} <a href="{{ articleUrl }}" class="thumbnail thumbLong">{{/hotlinkUrl}}<figure>{{#variant}} <span class="image"><img src="{{ url }}" alt="{{ title }}"> </span>{{/variant}}<figcaption>{{#subtitle}} <span class="tag">{{ subtitle }}</span> {{/subtitle}} <span class="title">{{ title }}</span> <span class="text">{{ description }}</span></figcaption></figure></a></a></section></li>{{/contents}}',PULSE.app.templates.latestmatchweekvideo='{{#contents}}<li data-ui-modal="#videoPlayer" data-ui-args="{{uiArgs}}"><a href="#!" class="thumbnail videoThumb"><figure><span class="image">{{#thumbnailUrl}} <img src="{{thumbnailUrl}}" alt=""> {{/thumbnailUrl}} <span class="runTime"><span class="icn play-w"></span> <time datetime="PT2M59S">{{durationString}}</time> {{#ccString}}<span class="closedCaption">{{ccString}}</span>{{/ccString}} {{#avString}}<span class="audioDesc">{{avString}}</span>{{/avString}}</span></span><figcaption><span class="title">{{title}}</span></figcaption></figure></a></li>{{/contents}}',PULSE.app.templates.nomatchweeklatestlist='<li class="noContentContainer">{{ label }}</li>',PULSE.app.templates.matchweekloadermodal='<div id="" class="pl-modal open"><div class="pl-modal__content mcLoader"><div class="mcLoading">{{ label }}</div><div class="loader-small"><div class="line"></div></div></div></div>',PULSE.app.templates.matchweekmatchbroadcaster='<span class="broadcaster"><div class="logo broadcaster-{{ abbreviation }}"></div></span>',PULSE.app.templates.matchweeknavdate='<li><div class="mcNavButton dayToggle open mcDayToggleNavContainer">{{ date }}<span class="icn chevron-downblack-normal"></span></div><ul class="{{ date }}MatchContainer dayList"></ul></li>',PULSE.app.templates.allquestions='<h3 class="subHeader">{{ questionLabel }}</h3><ul>{{#questions}}<li data-id="{{ id }}"><div class="question"><span>{{ text }}</span> <span class="icn arrow-right"></span></div></li>{{/questions}}</ul><h3 class="subHeader">{{ answerLabel }}</h3><ul>{{#answers}}<li data-id="{{ id }}"><div class="question"><span>{{ text }}</span> <span class="icn arrow-right"></span></div></li>{{/answers}}</ul>',PULSE.app.templates.pollanswers='<h3 class="subHeader">{{ question.text }}</h3><ul>{{#question.options}}<li><div class="question answer"><span>{{ text }}</span> <span>{{ percentage }}</span> <span class="bar" style="width: {{ percentage }};"></span></div></li>{{/question.options}}</ul>',PULSE.app.templates.pollquestionamount='<span class="questions"><strong class="">{{ number }}</strong></span>',PULSE.app.templates.pollquestions='<h3 class="subHeader">{{ question.text }}</h3><ul>{{#question.options}}<li data-optionid="{{ id }}" data-questionid="{{ question.id }}"><div class="question"><span>{{ text }}</span> <span class="icn tick-w"></span></div></li>{{/question.options}}</ul>',PULSE.app.templates.matchweektable='<tr class="{{ annotationClass }}" data-filtered-table-row="26" data-filtered-table-row-name="{{ longName }}" data-filtered-table-row-abbr="26"><td class="pos"><span class="value">{{ position }}</span> <span class="movement {{ movement }}"></span></td><td class="team" scope="row"><a href="{{ url }}"><span class="badge badge-image-container" data-widget="club-badge-image" data-size="20"><img class="badge-image badge-image--20 js-badge-image" src="{{ clubBadge }}" srcset="{{ clubBadge }}, {{ clubBadgeRetina }} 2x"> </span>{{ longName }}</a></td><td>{{ overall.played }}</td><td>{{ overall.goalsDifference }}</td><td class="points">{{ overall.points }}</td></tr>',function(p,o,n,g,a){function s(e){var t=this,a={method:"GET",callback:t.renderBlog,target:t};return e?(a.interval=p.pollingCacheRate,a.url=p.common.createLiveBlogPath(void 0,t.currentId,{maxResults:50})):a.url=p.common.createLiveBlogPath(void 0,t.currentId,{},t.belowPosition),a}function l(e,t){var a=this;a.blogFeeds[e]?isNaN(t.interval)?a.blogFeeds[e].request():a.blogFeeds[e].start():a.blogFeeds[e]=n.data.manager.add(t)}function i(e,t,a,n){for(var s in e){var o,l;e.hasOwnProperty(s)&&(l=(o=e[s]).config.url||"",isNaN(o.interval)||l.match("PremierLeague/"+a)||o.stop())}"function"==typeof n?n():console.warn("Error: Please supply a valid callback function to stopAnyOldPollingRequests")}p.matchWeekBlog=function(e){var t=this;t.element=e,t.liveVidiprinterContainer=t.element.getElementsByClassName("liveVidiprinterContainer"),t.vidiScrollUp=t.element.getElementsByClassName("vidiScrollUp"),t.vidiScrollDown=t.element.getElementsByClassName("vidiScrollDown"),t.blogCommentButton=t.element.getElementsByClassName("blogCommentButton"),t.blogAuthorContainer=t.element.getElementsByClassName("blogAuthorContainer"),t.blogStream=t.element.getElementsByClassName("matchweekBlogStream"),t.blogIds=[],t.blogFeeds=[],t.type="liveblog";e=document.querySelectorAll('[data-widget="match-week-events"]');0<e.length&&0<t.liveVidiprinterContainer.length&&(Array.prototype.forEach.call(e,function(e){t.liveVidiprinterContainer[0].appendChild(e)}),t.checkVidiScroller()),t.currentId=t.element.getAttribute("data-blog-id"),t.getBlog(),t.matchweekDayDropdownContainer=t.element.getElementsByClassName("matchweekDayDropdownContainer"),t.setListeners(),t.renderTabs(),t.loader=new p.common.scrollLoader(t.blogStream[0],t,!0)},p.matchWeekBlog.prototype.renderTabs=function(){var e=this,t={tabItems:e.element.getElementsByClassName("blogTabContainer"),tabLinkWrap:e.element.querySelector(".tabs"),builtClass:"mcBlog"};e.tabs=new a.tab(t)},p.matchWeekBlog.prototype.setListeners=function(){var e,t,a=this;0<a.matchweekDayDropdownContainer.length&&(e={updateCurrent:!0,callback:a.changeBlogDay,target:a},new o.dropdown(a.matchweekDayDropdownContainer[0],e)),0<a.vidiScrollUp.length&&0<a.liveVidiprinterContainer.length&&0<a.vidiScrollDown.length&&(a.vidiScrollUp[0].addEventListener("click",function(){a.liveVidiprinterContainer[0].scrollTop-=52}),a.vidiScrollDown[0].addEventListener("click",function(){a.liveVidiprinterContainer[0].scrollTop+=52}),a.liveVidiprinterContainer[0].addEventListener("scroll",function(){a.checkVidiScroller()})),0<a.blogCommentButton.length&&(t=a.blogCommentButton[0].getAttribute("data-email"),a.blogCommentButton[0].addEventListener("click",function(e){e.preventDefault(),window.location.href="mailto:"+t}))},p.matchWeekBlog.prototype.checkVidiScroller=function(){var e=this;0<e.vidiScrollUp.length&&0<e.liveVidiprinterContainer.length&&0<e.vidiScrollDown.length&&(e.liveVidiprinterContainer[0].scrollHeight-e.liveVidiprinterContainer[0].scrollTop===e.liveVidiprinterContainer[0].offsetHeight?n.style.addClass(e.vidiScrollDown[0],"collapsed"):n.style.removeClass(e.vidiScrollDown[0],"collapsed"),0===e.liveVidiprinterContainer[0].scrollTop?n.style.addClass(e.vidiScrollUp[0],"collapsed"):n.style.removeClass(e.vidiScrollUp[0],"collapsed"))},p.matchWeekBlog.prototype.changeBlogDay=function(e){var t=this,e=e.getAttribute("data-blog-id");e!=t.currentId&&(t.matchWeekBlogEntryContainer[0].innerHTML="",t.currentId=e,t.belowPosition=void 0,t.changeAuthor(e),t.blogIds=[],t.getBlog())},p.matchWeekBlog.prototype.changeAuthor=function(e){var t=this;if(0<t.blogAuthorContainer.length&&e)for(var a=0;a<t.blogAuthorContainer.length;a++){var n=t.blogAuthorContainer[a].getAttribute("data-blog-id");t.blogAuthorContainer[a].style.display=e!=n?"none":""}},p.matchWeekBlog.prototype.getBlog=function(){var e=this,t=s.call(this,!0),a="pollFeed"+t.url;i(e.blogFeeds,t.url,e.currentId,function(){l.call(e,a,t)})},p.matchWeekBlog.prototype.getOlderBlogEntries=function(){var e=this;if(0===e.belowPosition)return e.loader.contentLoaded(),void e.loader.completedDataLoad(!0);var t=s.call(this,!1),a="historicFeed"+t.url;i(e.blogFeeds,t.url,e.currentId,function(){l.call(e,a,t)})},p.matchWeekBlog.prototype.hasIdenticalBlogPosts=function(e){return 0!==this.blogIds.length&&(0===this.getNewBlogPosts(e).length&&0===this.getUpdatedBlogPosts(e).length&&0===this.getDeletedBlogPosts(e).length)},p.matchWeekBlog.prototype.getNewBlogPosts=function(e){var a=this;return e.filter(function(t){return a.blogIds.every(function(e){return t.id!==e.id})}.bind(a))},p.matchWeekBlog.prototype.getUpdatedBlogPosts=function(e){var n=this;return e.filter(function(t,e){var a=t.pinnedEntry||!1;return t.newIndex=e,n.blogIds.some(function(e){return t.id===e.id&&(t.updateTime!==e.updateTime||a!==e.pinnedEntry)})}.bind(n))},p.matchWeekBlog.prototype.getDeletedBlogPosts=function(a){return this.blogIds.filter(function(t,e){return t.newIndex=-1,a.every(function(e){return t.id!==e.id&&!t.nextPage})}.bind(this))},p.matchWeekBlog.prototype.renderBlogEntries=function(e,r){var c,m,t,a,d=this;d.matchWeekBlogEntryContainer=d.element.getElementsByClassName("matchWeekBlogEntryContainer"),0!==d.matchWeekBlogEntryContainer.length&&(a=d.rearrangeData(e),d.belowPosition=a[a.length-1].position,d.hasIdenticalBlogPosts(a)||(c=[],t=[],t=0<(m=d.getNewBlogPosts(a)).length?t.concat(m):t,r||(t=0<(e=d.getUpdatedBlogPosts(a)).length?t.concat(e):t,t=0<(a=d.getDeletedBlogPosts(a)).length?t.concat(a):t),t.forEach(function(t,e){var a=(i=t,o=e,l=new Date(i.timestamp),i.cardClass=0===o?"firstCard":"",i.time=moment(l).locale(p.language).tz(moment.tz.guess()).format("HH:mm"),i.iconClass=i.icon&&i.icon.html?i.icon.html:"",i.pinLabel=g.lookup("label.pinnedpost"),i),n=document.querySelectorAll('[data-post-id="'+a.id+'"]'),s=t.pinnedEntry||!1,e=s?"js-pinned-post":"js-post",o=d.matchWeekBlogEntryContainer[0].getElementsByClassName(e)||!1,l=s?"matchweekpinnedblogentry":"matchweekblogentry",i=t.newIndex||0;if(0<n.length){n[0].parentNode.removeChild(n[0]);n=d.blogIds.findIndex(function(e){return e.id===t.id});if(d.blogIds.splice(n,1),i<0)return}c.push({id:t.id,updateTime:t.updateTime,pinnedEntry:s,nextPage:r});s=document.createElement("LI");s.setAttribute("class",e),s.setAttribute("data-post-id",a.id),s.innerHTML=Mustache.render(p.templates[l],a),!r&&d.matchWeekBlogEntryContainer[0].childNodes.length>m.length?o?0<i?d.matchWeekBlogEntryContainer[0].insertBefore(s,d.matchWeekBlogEntryContainer[0].childNodes[i]):d.matchWeekBlogEntryContainer[0].insertBefore(s,o[i]):d.matchWeekBlogEntryContainer[0].insertBefore(s,d.matchWeekBlogEntryContainer[0].firstElementChild):d.matchWeekBlogEntryContainer[0].appendChild(s)}),d.blogIds=d.blogIds.concat(c),o.refreshScripts(d.matchWeekBlogEntryContainer[0])))},p.matchWeekBlog.prototype.rearrangeData=function(e){var t=void 0!==e.entries&&0<e.entries.length?e.entries.slice(0):e,e=e.overview?e.overview.header.keyEvents:[],n=t.sort(function(e,t){return t.position-e.position}),a=[],s=[];return e.forEach(function(t,e){var a=n.findIndex(function(e){return e.id===t.entryId});0<=a&&(n[a].pinnedEntry=!0)}),n.forEach(function(e,t){(e.pinnedEntry||!1?a:s).push(e)}),a.concat(s)},p.matchWeekBlog.prototype.renderHeader=function(e){var t=this;t.headerEventsContainer=t.element.getElementsByClassName("headerEventsContainer");var a,n,s=e.overview.header.headerEvents;0<t.headerEventsContainer.length&&s&&(a="",s.forEach(function(e){a+=Mustache.render(p.templates.matchweekheaderevent,e)}),t.headerEventsContainer[0].innerHTML=a),t.matchweekBlogImageContainer=t.element.getElementsByClassName("matchweekBlogImageContainer"),t.matchweekBlogImageText=t.element.getElementsByClassName("js-matchweekBlogImageText"),0<t.matchweekBlogImageContainer.length&&(n="",!e.overview.header.leadMedia||"photo"!==e.overview.header.leadMedia.type||(s=o.getVariantWithWidth(e.overview.header.leadMedia.variants,900))&&(n=s.url),t.url!==n&&(t.matchweekBlogImageContainer[0].style.backgroundImage="url("+n+")",t.url=n)),0<t.matchweekBlogImageText.length&&(n=e.overview.header.leadMedia.title||"",t.matchweekBlogImageText[0].innerHTML=n),t.headerTitleContainer=t.element.getElementsByClassName("headerTitleContainer"),0<t.headerTitleContainer.length&&(t.headerTitleContainer[0].innerHTML=e.overview.header.title)},p.matchWeekBlog.prototype.didRequestLoad=function(){this.getOlderBlogEntries()},p.matchWeekBlog.prototype.renderBlog=function(e,t){var a=-1===t.url.indexOf("below/");this.loader.contentLoaded(),e?(this.renderBlogEntries(e,!a),e.overview&&e.overview.header&&this.renderHeader(e,t)):this.loader.removeLoader()};for(var e=[].slice.call(document.querySelectorAll('[data-widget="match-week-blog"]')),t=0;t<e.length;t++)new p.matchWeekBlog(e[t],{})}(PULSE.app,PULSE.app.common,PULSE.core,PULSE.I18N,PULSE.ui),function(l,i,s,r,a){function o(a,e){var n=[],s=e?"team-two":"lowLight";switch(a.eventJson=JSON.stringify(a),["homeTeam","awayTeam"].forEach(function(e){var t={optaId:a[e].altIds.opta,clubBadge:i.getClubBadge(a[e].altIds.opta,"25"),clubBadgeRetina:i.getClubBadge(a[e].altIds.opta,"25",!0),clubBadgeSmall:i.getClubBadge(a[e].altIds.opta,"20"),clubBadgeSmallRetina:i.getClubBadge(a[e].altIds.opta,"20",!0),name:a[e].name,abbr:a[e].club.abbr,teamClass:"",url:i.generateContentUrl("team",a[e].club.id,a[e].club.name.replace(new RegExp(" ","g"),"-"))};"homeTeam"===e?(t.score=a.score.homeScore,a.teamId!==a.homeTeam.id&&(t.teamClass=s)):(t.score=a.score.awayScore,a.teamId!==a.awayTeam.id&&(t.teamClass=s)),n.push(t)}),a.teams=n,a.time=i.getEventTime(a),a.person&&(a.personName=a.person.name.display,"O"===a.description?a.personName+="( "+r.lookup("label.owngoal.short")+" )":"P"===a.description&&(a.personName+="( "+r.lookup("label.penalty.short")+")"),a.personUrl=i.generateContentUrl("player",a.person.id,a.person.name.display.replace(new RegExp(" ","g"),"-")),e&&(a.playerImage={},a.playerImage.imageSize="80x100",a.playerImage.image=i.getDefaultPlayerImg(a.imageSize),a.playerImage.optaId=a.person.altIds&&a.person.altIds.opta?a.person.altIds.opta:void 0)),a.assistPerson&&(a.assistLabel={short:r.lookup("label.assist.short")+".",long:r.lookup("label.assistedby")},a.assistName=a.assistPerson.name.display,a.assistUrl=i.generateContentUrl("player",a.assistPerson.id,a.assistPerson.name.display.replace(new RegExp(" ","g"),"-"))),"G"!==a.type&&(!a.description||"Y"!==a.description&&"YR"!==a.description&&"R"!==a.description)||(a.modalLink=!0),a.description){case"G":case"P":case"O":a.eventType="popUp goal";break;case"Y":case"R":case"YR":a.eventType="popUp";break;default:a.eventType="time"}return a.eventLabel=i.getEventLabel(a),a.eventClass=i.getEventTypeClass(a),a.url=i.generateContentUrl("match",a.fixtureId),a.mcLabel=r.lookup("label.matchcentre"),a}l.matchWeekEvents=function(e,t){var a=this;a.element=e,a.matchweekEventsContainer=a.element.getElementsByClassName("matchweekEventsContainer"),a.compSeason=a.element.getAttribute("data-compseasons"),a.gameWeek=a.element.getAttribute("data-gameweeks"),a.statFeed={},a.initModel();new i.checkGameweek({compSeason:a.compSeason,gameWeek:a.gameWeek,target:this,callback:a.initEventData})},l.matchWeekEvents.prototype.initModel=function(){var t=this,e={parent:t.element,selector:"[data-ui-modal]",openClass:"open",modalId:"modalWrap",closeText:"close",openCallback:function(e){t.updateModal(e)},modalWrapClass:"pl-modal",modalContentWrapClass:"pl-modal__content"};t.modal=new a.modal(e)},l.matchWeekEvents.prototype.updateModal=function(e){var t=e.config.current.uiArgs,a=e.config.current.content,e=a.getElementsByClassName("eventDetails"),a=a.getElementsByClassName("statLeaders");a&&0<a.length&&(a[0].innerHTML="",this.getTopPlayers(t,a[0])),e&&0<e.length&&(t=o(t,!0),t=Mustache.render(l.templates.eventmodaldetails,t),e[0].innerHTML=t,l.clubBadge(e[0],!0),i.getPhotosForContainer(e[0]))},l.matchWeekEvents.prototype.getTopPlayers=function(e,t){var a=this;"G"===e.type?("O"===e.description?a.getTopPlayersFeed("own_goals",t):"P"===e.description?a.getTopPlayersFeed("att_pen_goal",t):a.getTopPlayersFeed("goals",t),e.assistId&&a.getTopPlayersFeed("goal_assist",t)):"Y"===e.description?a.getTopPlayersFeed("yellow_card",t):a.getTopPlayersFeed("red_card",t)},l.matchWeekEvents.prototype.getTopPlayersFeed=function(e,t){var a=this,n={compSeasons:a.compSeason,altIds:!0,pageSize:3,page:0,statistic:e,compCodeForActivePlayer:l.defaultCompCode},t={url:l.common.createApiPath("stats.ranked.players",n),method:"GET",callback:a.renderTopPlayers,target:this,container:t,stat:e,interval:l.pollingCacheRate,compSeason:a.compSeason};a.statFeed[e]?a.statFeed[e].start():a.statFeed[e]=s.data.manager.add(t)},l.matchWeekEvents.prototype.renderTopPlayers=function(e,t){if(this.statFeed[t.stat]&&this.statFeed[t.stat].stop(),e&&e.stats&&e.stats.content&&0<e.stats.content.length&&t&&t.container){var a="/stats/top/players/"+e.entity;t.compSeason&&(a+="?se="+t.compSeason);var n={statLabel:r.lookup("label.stat."+e.entity),linkLabel:r.lookup("action.viewfulltable"),url:a,stats:[]};e.stats.content.forEach(function(e,t){n.stats.push((t=t,(e=e).owner&&(e.url=i.generateContentUrl("player",e.owner.id,e.owner.name.display.replace(new RegExp(" ","g"),"-"))),e.index=t+1,e.statsBadgeClass="",0===t?(e.imageSize="110x140",e.playerImage=i.getDefaultPlayerImg(e.imageSize),e.optaId=e.owner&&e.owner.altIds&&e.owner.altIds.opta?e.owner.altIds.opta:void 0,e.statsClass="statsHero",e.statsBadgeClass="heroBadgeContainer",e.teamInfoClass="",e.smallTeamBadge=!1,e.largeTeamBadge=!0):(e.statsClass="statsRow",e.teamInfoClass="teamInfo",e.smallTeamBadge=!0,e.largeTeamBadge=!1),e.owner&&e.owner.currentTeam&&(e.team={url:i.generateContentUrl("team",e.owner.currentTeam.club.id,e.owner.currentTeam.club.name.replace(new RegExp(" ","g"),"-")),opta:e.owner.currentTeam.altIds.opta,name:e.owner.currentTeam.name,clubBadge:i.getClubBadge(e.owner.currentTeam.altIds.opta,"25"),clubBadgeRetina:i.getClubBadge(e.owner.currentTeam.altIds.opta,"25",!0),clubBadgeSmall:i.getClubBadge(e.owner.currentTeam.altIds.opta,"20"),clubBadgeSmallRetina:i.getClubBadge(e.owner.currentTeam.altIds.opta,"20",!0)}),e))});e=Mustache.render(l.templates.topplayer,n);t.container.innerHTML+=e,l.clubBadge(t.container,!0);for(var s=t.container.getElementsByClassName("statsCardSocialShare"),o=0;o<s.length;o++)new i.pageShare(s[o]);i.getPhotosForContainer(t.container)}},l.matchWeekEvents.prototype.initEventData=function(e){e&&(e={id:this.compSeason,gw:this.gameWeek,altIds:!0},e={url:l.common.createApiPath("competition-season.gameweeks.events.single",e),method:"GET",callback:this.renderEvents,target:this,interval:l.pollingCacheRate},this.startData(e))},l.matchWeekEvents.prototype.renderEvents=function(e){var s;e&&e.events&&this.matchweekEventsContainer&&0<this.matchweekEventsContainer.length&&(s="",0<e.events.length&&(e.events.reverse(),e.events.forEach(function(e){var t=o(e),a=document.createElement("li"),n=void 0,n=t.modalLink?(a.setAttribute("data-ui-modal","#matchWeekEventsModal"),a.setAttribute("data-ui-args",e.eventJson),a):((e=document.createElement("a")).setAttribute("href",t.url),a.appendChild(e),e),t=Mustache.render(l.templates.matchweekevent,t);n.innerHTML=t,l.clubBadge(n,!0),s+=a.outerHTML})),0===e.events.length&&(s=Mustache.render(l.templates.nomatchevents,{label:r.lookup("label.nomatchevents")})),this.matchweekEventsContainer[0].innerHTML=s,this.initModel())},l.matchWeekEvents.prototype.startData=function(e){s.data.manager.add(e)};for(var e=document.querySelectorAll('[data-widget="match-week-events"]'),t=0;t<e.length;t++)new l.matchWeekEvents(e[t],{})}(PULSE.app,PULSE.app.common,PULSE.core,PULSE.I18N,PULSE.ui),function(o,l,t,i){o.matchWeekLatestTeamFilter=function(e,t){var a,n=this;for(a in n.element=e,n.gameweek=n.element.getAttribute("data-gameweek"),n.contentTypes={text:{container:document.querySelectorAll('[data-widget="match-week-latest-news"]'),template:"latestmatchweektext"},video:{container:document.querySelectorAll('[data-widget="match-week-latest-videos"]'),template:"latestmatchweekvideo"}},n.contentTypes)n.contentTypes[a].container&&0<n.contentTypes[a].container.length&&(n.contentTypes[a].pageSize=n.contentTypes[a].container[0].getAttribute("data-page-size"),"video"===a&&(n.videoList=new l.videoList(n.contentTypes[a].container[0])));e={callback:n.filterByTeam,updateCurrent:!0,target:n},new l.dropdown(n.element,e)},o.matchWeekLatestTeamFilter.prototype.filterByTeam=function(e){e=e.getAttribute("data-club-id");this.clubId="-1"!=e?e:void 0,this.getMatchContent("text"),this.getMatchContent("video")},o.matchWeekLatestTeamFilter.prototype.renderContent=function(e,t){var a,n,s=this;e&&e.content&&(a=t.contentType,s.contentTypes[a].container&&0<s.contentTypes[a].container.length&&(t="",n=[],e.content.forEach(function(e){n.push(l.getContentModel(e))}),t=e.content.length<1&&("video"===a||"text"===a)?Mustache.render(o.templates.nomatchweeklatestlist,{label:i.lookup("label.nocontent"+a)}):(e={contents:n},Mustache.render(o.templates[s.contentTypes[a].template],e)),s.contentTypes[a].container[0].innerHTML=t,"video"===a&&(s.videoList=new l.videoList(s.contentTypes.video.container[0]))))},o.matchWeekLatestTeamFilter.prototype.getMatchContent=function(e){var t=this,a=["FOOTBALL_GAMEWEEK:"+t.gameweek];t.clubId&&a.push("FOOTBALL_CLUB:"+t.clubId);a={page:0,references:a.join(","),pageSize:t.contentTypes[e].pageSize},e={url:o.common.createContentPath(e,a),method:"GET",callback:t.renderContent,contentType:e,target:this};this.startData(e)},o.matchWeekLatestTeamFilter.prototype.startData=function(e){t.data.manager.add(e)};for(var e=document.querySelectorAll('[data-widget="match-week-latest-team-filter"]'),a=0;a<e.length;a++)new o.matchWeekLatestTeamFilter(e[a],{})}(PULSE.app,PULSE.app.common,PULSE.core,PULSE.I18N),function(n,s,o,l){n.matchWeekNav=function(e,t){var a=this;a.element=e,a.matchWeekFixtureListContainer=a.element.getElementsByClassName("matchWeekFixtureListContainer"),s.renderKickOffData(a.element,{className:"renderKOContainer",format:"HH:mm"}),a.matchWeekFixtureListContainer&&0<a.matchWeekFixtureListContainer.length&&s.orderKickOffs(a.element,a.matchWeekFixtureListContainer[0],n.templates.matchweeknavdate,{format:"dddd D MMMM",className:"matchWeekMatchContainer"}),a.autoUrl=a.element.getAttribute("data-auto-url"),o.url.getParameterByName("match")&&(e={label:l.lookup("label.loadingmatchcentre")},a.element.innerHTML=Mustache.render(n.templates.matchweekloadermodal,e),window.location.href=a.autoUrl),a.mcDayToggleNavContainer=a.element.getElementsByClassName("mcDayToggleNavContainer"),a.matchWeekTableButton=a.element.getElementsByClassName("matchWeekTableButton"),a.scoresButton=a.element.getElementsByClassName("scoresButton"),a.scoresContainer=a.element.getElementsByClassName("matchList"),a.matchWeekLeagueTableContainer=a.element.getElementsByClassName("matchWeekLeagueTableContainer"),a.navButtons=a.element.getElementsByClassName("mcNavButton"),a.setListeners(),a.requestConfig={page:0},a.requestConfig.gameweeks=a.element.getAttribute("data-gameweeks"),a.sort=a.element.getAttribute("data-sort"),"DESCENDING"===a.sort?a.requestConfig.sort="desc":a.requestConfig.sort=void 0;new s.pollMatches(a.element,a.requestConfig,{matchClass:"matchNavMatchContainer"}),new s.getBroadcasters(a.element,{containerClass:"mcNavBroadcasterContainer"})},n.matchWeekNav.prototype.setListeners=function(){var a=this;Array.prototype.map.call(a.mcDayToggleNavContainer,function(e){e.addEventListener("click",function(){o.style.toggleClass(e,"open")})}),a.matchWeekTableButton&&0<a.matchWeekTableButton.length&&a.matchWeekLeagueTableContainer&&0<a.matchWeekLeagueTableContainer.length&&a.matchWeekTableButton[0].addEventListener("click",function(e,t){e.preventDefault(),a.matchWeekTable?a.matchWeekTable.toggleOpen():a.matchWeekTable=new n.matchWeekTable(a.matchWeekLeagueTableContainer[0],{})})};for(var e=document.querySelectorAll('[data-widget="match-week-nav"]'),t=0;t<e.length;t++)new n.matchWeekNav(e[t],{})}(PULSE.app,PULSE.app.common,PULSE.core,PULSE.I18N),function(o,a,s,l){function i(e){return!(!(e=s.localStorage.getStorage(o.cookiePrefix+"Matchweekpoll"+e.id,!0))||""==e)}o.matchWeekPoll=function(e,t){var a=this;a.element=e,a.gameweek=a.element.getAttribute("data-gameweek"),a.fanPollQuestionNumberContainer=a.element.getElementsByClassName("fanPollQuestionNumberContainer"),a.matchWeekPollButton=a.element.getElementsByClassName("matchWeekPollButton"),a.matchWeekQuestionContainer=a.element.getElementsByClassName("matchWeekQuestionContainer"),a.allQuestionsContainer=a.element.getElementsByClassName("allQuestionsContainer"),a.matchweekOptionsContainer=a.element.getElementsByClassName("matchweekOptionsContainer"),a.matchWeekOptionRenderContainer=a.element.getElementsByClassName("matchWeekOptionRenderContainer"),a.matchweekOptionsBackButton=a.element.getElementsByClassName("matchweekOptionsBackButton"),a.matchweekOptionsCloseButton=a.element.getElementsByClassName("matchweekOptionsCloseButton"),a.pollName="pl_2016_17",a.questions=[],a.answers=[],a.questionMap={},a.setListeners(),a.refreshPollData()},o.matchWeekPoll.prototype.setListeners=function(){var n=this;n.matchWeekPollButton&&0<n.matchWeekPollButton.length&&n.matchWeekPollButton[0].addEventListener("click",function(){n.matchWeekQuestionContainer&&0<n.matchWeekQuestionContainer.length&&(s.style.addClass(n.matchWeekQuestionContainer[0],"open"),s.style.addClass(n.element,"open"))}),n.allQuestionsContainer&&0<n.allQuestionsContainer.length&&n.allQuestionsContainer[0].addEventListener("click",function(e){for(var t=e.target;t&&t.parentNode!==n.allQuestionsContainer[0]&&t.parentNode&&"UL"!==t.parentNode.tagName;)if(!(t=t.parentNode))return;"LI"===t.tagName&&(e=t.getAttribute("data-id"),n.renderQuestion(e))}),n.matchweekOptionsBackButton&&0<n.matchweekOptionsBackButton.length&&n.matchweekOptionsBackButton[0].addEventListener("click",function(e){n.currentQuestion=void 0,n.allQuestionsContainer&&0<n.allQuestionsContainer.length&&(n.allQuestionsContainer[0].style.display=""),n.matchweekOptionsContainer&&0<n.matchweekOptionsContainer.length&&(n.matchweekOptionsContainer[0].style.display="none")}),n.matchweekOptionsCloseButton&&0<n.matchweekOptionsCloseButton.length&&n.matchweekOptionsCloseButton[0].addEventListener("click",function(e){s.style.removeClass(n.matchWeekQuestionContainer[0],"open"),s.style.removeClass(n.element,"open")}),n.matchWeekOptionRenderContainer&&0<n.matchWeekOptionRenderContainer.length&&n.matchWeekOptionRenderContainer[0].addEventListener("click",function(e){for(var t,a=e.target;a&&a.parentNode!==n.matchWeekOptionRenderContainer[0]&&a.parentNode&&"UL"!==a.parentNode.tagName;)if(!(a=a.parentNode))return;"LI"===a.tagName&&(t=a.getAttribute("data-optionid"),e=a.getAttribute("data-questionid"),null!=t&&null!=e&&n.answerQuestion(e,t))})},o.matchWeekPoll.prototype.answerQuestion=function(e,t){t={url:a.createPollAnswerUrl(e,t),method:"GET",callback:this.answeredQuestion,target:this,jsonpCallback:"JSON_CALLBACK",questionId:e,optionId:t};s.data.manager.add(t)},o.matchWeekPoll.prototype.answeredQuestion=function(e,t){e&&t&&t.questionId&&a.setCookie(o.cookiePrefix+"Matchweekpoll"+t.questionId,t.optionId,100,!0),this.questionMap[t.questionId]&&(this.questionMap[t.questionId].hasAnswer=!0,this.renderQuestion(t.questionId),this.initPollData(!0))},o.matchWeekPoll.prototype.initPollData=function(e){var t={url:a.createPollQuestionUrl(this.pollName),method:"GET",callback:this.renderPoll,target:this,jsonpCallback:"onPoll",forceCallback:!0,forced:e};e||(t.interval=o.pollingCacheRate),this.getPoll||e?e&&s.data.manager.add(t):this.getPoll=s.data.manager.add(t)},o.matchWeekPoll.prototype.refreshPollData=function(){this.initPollData()},o.matchWeekPoll.prototype.renderPoll=function(e,t){var a,n,s=this;e&&0<e.length&&(n=a=!1,e.forEach(function(e){var t;e.open&&(t=i(e),s.questionMap&&s.questionMap[s.currentQuestion]&&s.questionMap[s.currentQuestion].hasAnswer?e.hasAnswer=!0:e.hasAnswer=t,e.id==s.currentQuestion&&JSON.stringify(s.questionMap[s.currentQuestion])!=JSON.stringify(e)&&(n=!0),JSON.stringify(s.questionMap[e.id])!=JSON.stringify(e)&&(a=!0),s.questionMap[e.id]=e)}),(a||t.forced)&&(s.getQuestionAmount(),s.renderAllQuestions()),null!=s.currentQuestion&&n&&s.renderQuestion(s.currentQuestion))},o.matchWeekPoll.prototype.refreshAnswersAndQuestions=function(e){var a=this;e.forEach(function(e){var t=i(e);e.hasAnswer=t,a.questionMap[e.id]=e})},o.matchWeekPoll.prototype.renderQuestion=function(e){var t,a,n=this;n.currentQuestion=e,n.allQuestionsContainer&&0<n.allQuestionsContainer.length&&(n.allQuestionsContainer[0].style.display="none"),n.matchweekOptionsContainer&&0<n.matchweekOptionsContainer.length&&(n.matchweekOptionsContainer[0].style.display="",n.matchWeekOptionRenderContainer&&0<n.matchWeekOptionRenderContainer.length&&((a=n.questionMap[e])&&(e="pollquestions",a.hasAnswer&&(e="pollanswers"),t=0,a={question:a,idx:function(){return t++}},n.matchWeekOptionRenderContainer[0].innerHTML=Mustache.render(o.templates[e],a))))},o.matchWeekPoll.prototype.getQuestionAmount=function(){var e=this;if(e.fanPollQuestionNumberContainer&&0<e.fanPollQuestionNumberContainer.length){var t="";if(e.questionMap){var a,n=0;for(a in e.questionMap)e.questionMap[a].hasAnswer||n++;0<n&&(t+=Mustache.render(o.templates.pollquestionamount,{number:n}))}e.fanPollQuestionNumberContainer[0].innerHTML=t}},o.matchWeekPoll.prototype.renderAllQuestions=function(){var e=this;if(e.allQuestionsContainer&&0<e.allQuestionsContainer.length){var t,a=[],n=[];for(t in e.questionMap)(e.questionMap[t].hasAnswer?n:a).push(e.questionMap[t]);var s={questions:a,answers:n,questionLabel:l.lookup("label.openquestions"),answerLabel:l.lookup("label.answeredquestions")};e.allQuestionsContainer[0].innerHTML=Mustache.render(o.templates.allquestions,s)}};for(var e=document.querySelectorAll('[data-widget="match-week-poll"]'),t=0;t<e.length;t++)new o.matchWeekPoll(e[t],{})}(PULSE.app,PULSE.app.common,PULSE.core,PULSE.I18N),function(s,n,o,l){s.matchWeekTable=function(e,t){var a=this;a.element=e,a.liveTableContainer=a.element.getElementsByClassName("liveTableContainer"),a.standingEntriesContainer=a.element.getElementsByClassName("standingEntriesContainer"),a.matchweekAmountContainer=a.element.getElementsByClassName("matchweekAmountContainer"),a.tableCloseButtonContainer=a.element.getElementsByClassName("tableCloseButtonContainer"),a.gameWeek=a.element.getAttribute("data-gameweek"),a.compSeason=a.element.getAttribute("data-compseason"),a.competition=a.element.getAttribute("data-competition"),a.gameweekAmount=a.element.getAttribute("data-gameweeknumber"),a.live=a.element.getAttribute("data-live"),a.liveLeague=a.element.getElementsByClassName("js-live-toggle-container"),a.setListeners(),n.style.toggleClass(a.element,"open"),a.compSeason&&a.live&&(a.shouldDisplayLiveLeague()?a.getLiveFixtures():a.getLiveTable(!1)),a.gameweekAmount&&a.compSeason&&a.checkSeasonAndGameweek(a.compSeason,a.gameweekAmount),a.gameWeek&&a.getCompSeason()},s.matchWeekTable.prototype.shouldDisplayLiveLeague=function(){var e=s.competition.FIRST===parseInt(this.competition),t=parseInt(this.compSeason)===s.newSeason.FIRST;return this.liveLeague&&t&&e},s.matchWeekTable.prototype.getLiveFixtures=function(){var e=this;e.liveFixtures=new o.liveFixtures({comps:e.competition,compSeason:e.compSeason,target:this,container:e.liveLeague[0],callback:e.gotLiveFixtures})},s.matchWeekTable.prototype.gotLiveFixtures=function(e){e=e&&e.length;this.getLiveTable(e)},s.matchWeekTable.prototype.getCompSeason=function(){var e={id:this.gameWeek},e={url:s.common.createApiPath("gameweeks.single",e),method:"GET",callback:this.findCompSeason,target:this};n.data.manager.add(e)},s.matchWeekTable.prototype.findCompSeason=function(e){var t=this;e&&e.compSeason&&(e.gameweeks&&0<e.gameweeks.length&&(t.compSeason=e.compSeason.id,t.gameweekAmount=e.gameweeks[0].gameweek,t.checkSeasonAndGameweek(t.compSeason,t.gameweekAmount)),e.compSeason.competition&&(t.competition=e.compSeason.competition.id))},s.matchWeekTable.prototype.checkSeasonAndGameweek=function(e,t){var a,n=this;n.matchweekAmountContainer&&0<n.matchweekAmountContainer.length&&(a=l.lookup("label.matchweek")+" "+t,n.matchweekAmountContainer[0].innerHTML=a),n.checkGameweek=new o.checkGameweek({compSeason:e,gameWeek:t,target:this,callback:n.initLiveTable})},s.matchWeekTable.prototype.toggleOpen=function(){n.style.hasClass(this.element,"open")?this.stopFeed():this.startFeeds(),n.style.toggleClass(this.element,"open")},s.matchWeekTable.prototype.startFeeds=function(){this.livePoll&&this.isLive&&this.livePoll.start()},s.matchWeekTable.prototype.setListeners=function(){var e=this;e.tableCloseButtonContainer&&0<e.tableCloseButtonContainer.length&&e.tableCloseButtonContainer[0].addEventListener("click",function(){n.style.removeClass(e.element,"open"),e.stopFeed()})},s.matchWeekTable.prototype.initLiveTable=function(e){e&&this.shouldDisplayLiveLeague()?this.getLiveFixtures():this.getLiveTable(!1)},s.matchWeekTable.prototype.getLiveTable=function(e){var t=this,a={compSeasons:t.compSeason,altIds:!0};!e&&t.gameweekAmount?a.gameweekNumbers="1-"+t.gameweekAmount:e&&(a.live=!0);a={url:s.common.createApiPath("standings.all",a),method:"GET",callback:t.renderTable,target:this};e&&(a.interval=6e4,t.isLive=!0),this.startData(a)},s.matchWeekTable.prototype.startData=function(e){this.livePoll=n.data.manager.add(e)},s.matchWeekTable.prototype.stopFeed=function(){this.livePoll&&this.livePoll.stop()},s.matchWeekTable.prototype.renderTable=function(e){var n=this;e&&e.tables&&n.standingEntriesContainer&&0<n.standingEntriesContainer.length&&(e.tables,e.tables.forEach(function(e,t){var a="";e.entries&&(e.entries.sort(function(e,t){return e.position-t.position}),e.entries.forEach(function(e,t){e=function(e){e.url=e.team&&e.team.club?o.generateContentUrl("team",e.team.club.id,e.team.club.name.replace(new RegExp(" ","g"),"-")):"",e.opta=e.team&&e.team.altIds&&e.team.altIds.opta?e.team.altIds.opta:"",e.clubBadge=o.getClubBadge(e.opta,"20"),e.clubBadgeRetina=o.getClubBadge(e.opta,"20",!0);var t=parseInt(e.overall.goalsDifference);return e.overall.goalsDifference=0<t?"+"+t:t,e.longName=e.team&&e.team.shortName?e.team.shortName:e.team.name,e.movement="none",e.position<e.startingPosition?e.movement="up":e.position>e.startingPosition&&(e.movement="down"),e.annotationClass=o.getTableRowClass(e),e}(e);a+=Mustache.render(s.templates.matchweektable,e)})),n.standingEntriesContainer[t].innerHTML=a,s.clubBadge(n.standingEntriesContainer[t],!0)}))};var e=document.querySelectorAll('[data-widget="match-week-table"]');Array.prototype.map.call(e,function(e){e=new s.matchWeekTable(e,{})})}(PULSE.app,PULSE.core,PULSE.app.common,(PULSE.ui,PULSE.I18N));